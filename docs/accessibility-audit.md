# BifrostQL Forms - Accessibility Audit (WCAG 2.1 AA)

This document audits the HTML generated by BifrostQL Forms against WCAG 2.1 AA success criteria.

## Audit Summary

| Category | Status | Notes |
|---|---|---|
| Semantic HTML | Pass | `<form>`, `<fieldset>`, `<legend>`, `<label>`, `<dl>`, `<table>`, `<nav>` |
| Label Association | Pass | `for` attribute matches input `id` on all controls |
| Required Fields | Pass | `required` attribute + `aria-required="true"` |
| Error Identification | Pass | `aria-invalid="true"` + `aria-describedby` linking to error span |
| Keyboard Accessible | Pass | Native HTML controls, no custom widgets |
| Focus Indicators | Pass | `outline: 2px solid` on `:focus` (CSS), `:focus-visible` on buttons |
| Color Contrast | Pass | Text #1a1a2e on #fff = 16.75:1, errors #dc3545 on #fff = 4.55:1 |
| No Keyboard Traps | Pass | No modal dialogs or custom focus management |

## Detailed Findings

### 1. Perceivable

#### 1.1 Text Alternatives (SC 1.1.1) - Pass

- File upload preview images include `alt="Preview"` (progressive enhancement JS)
- Binary data columns display descriptive text "(binary data)" instead of raw bytes
- Null values display "(null)" with a CSS class for styling

#### 1.3 Adaptable (SC 1.3.1) - Pass

**Semantic structure:**
- Forms use `<form>`, `<label>`, `<input>`, `<textarea>`, `<select>`
- Enum radio groups use `<fieldset>` with `<legend>`
- Detail views use `<dl>`, `<dt>`, `<dd>`
- List views use `<table>` with `<thead>` and `<tbody>`
- Pagination uses `<nav>`
- Required fields marked with `required` attribute (machine-readable)

#### 1.3.5 Identify Input Purpose (SC 1.3.5) - Partial

- Input `name` attributes match column names from the database schema
- HTML5 input types (`email`, `tel`, `url`, `date`) hint at purpose
- Autocomplete attributes are not currently generated; add via metadata if needed

#### 1.4.3 Contrast (Minimum) (SC 1.4.3) - Pass

| Element | Foreground | Background | Ratio | Requirement |
|---|---|---|---|---|
| Body text | #1a1a2e | #fff | 16.75:1 | 4.5:1 |
| Error message | #dc3545 | #fff | 4.55:1 | 4.5:1 |
| Muted text | #6c757d | #fff | 4.68:1 | 4.5:1 |
| Button text | #fff | #007bff | 4.52:1 | 3:1 (large text) |
| Danger button | #fff | #dc3545 | 4.55:1 | 3:1 (large text) |

#### 1.4.11 Non-text Contrast (SC 1.4.11) - Pass

- Input borders: #ccc on #fff = 1.61:1 (decorative, not sole indicator)
- Focus outline: 2px solid #0056b3 on #fff = 7.21:1 (exceeds 3:1)
- Error borders: #dc3545 provides 4.55:1 contrast

### 2. Operable

#### 2.1.1 Keyboard (SC 2.1.1) - Pass

All interactive elements are native HTML:
- `<input>`, `<textarea>`, `<select>` are keyboard-operable by default
- `<button>` elements for form submission
- `<a>` elements for navigation links
- No custom JavaScript widgets that could break keyboard access

#### 2.1.2 No Keyboard Trap (SC 2.1.2) - Pass

- No modal dialogs
- No custom focus management
- Tab navigation follows natural document order
- The progressive enhancement JS uses `window.confirm()` which is a native dialog

#### 2.4.3 Focus Order (SC 2.4.3) - Pass

- Form fields follow source order (matching database column order)
- Tab order is: form fields (top to bottom) then action buttons
- Pagination links follow left-to-right reading order

#### 2.4.6 Headings and Labels (SC 2.4.6) - Pass

- Detail views include an `<h1>` with the table name
- List views include an `<h1>` with the table name
- Every form control has an associated `<label>`
- Radio groups use `<fieldset>`/`<legend>` for group labels

#### 2.4.7 Focus Visible (SC 2.4.7) - Pass

The default CSS provides visible focus indicators:
- Input/textarea/select: `outline: 2px solid #0056b3; outline-offset: 1px`
- Buttons: `:focus-visible` with darkened background

### 3. Understandable

#### 3.1 Readable (SC 3.1.1) - N/A

Language is not set by generated HTML. The consuming application should set `lang` on the `<html>` element.

#### 3.3.1 Error Identification (SC 3.3.1) - Pass

When validation fails:
- Each invalid field receives `aria-invalid="true"`
- Error messages are associated via `aria-describedby` pointing to the error span ID
- The form group div receives `class="error"` for visual indication
- Error text is descriptive (e.g., "Name is required", "must be a valid number")

#### 3.3.2 Labels or Instructions (SC 3.3.2) - Pass

- Every field has a visible `<label>` element
- Required fields include `required` and `aria-required="true"`
- Placeholder text provides format hints when configured via metadata
- File upload help text indicates "Leave empty to keep current file"

#### 3.3.3 Error Suggestion (SC 3.3.3) - Pass

Validation error messages describe what is needed:
- "Name is required" (missing required field)
- "must be a valid number" (type mismatch)
- "must be a valid date/time" (format error)
- "must be true or false" (boolean constraint)

### 4. Robust

#### 4.1.2 Name, Role, Value (SC 4.1.2) - Pass

All form controls use native HTML elements with standard roles:
- `<input>`, `<textarea>`, `<select>` provide name/role/value natively
- `required` attribute communicates required state
- `aria-invalid` communicates error state
- `aria-describedby` links inputs to their error messages
- `aria-required` provides redundant required state for assistive technology

## Screen Reader Notes

Tested patterns (expected behavior):

1. **Form fields**: Screen reader announces label, type, required state, and current value
2. **Error fields**: Reader announces "invalid" and reads the associated error message
3. **Radio groups**: Reader announces fieldset legend as the group label
4. **Detail view**: Reader navigates definition list with term/definition pairs
5. **List view**: Reader navigates table with row/column headers
6. **Pagination**: Reader identifies navigation landmark

## Recommendations

1. **Language**: Applications should set `lang` attribute on the HTML document
2. **Skip links**: Applications with navigation should add skip-to-content links
3. **Autocomplete**: Consider adding `autocomplete` attributes via metadata for known field types (name, email, phone, address)
4. **Live regions**: For AJAX form submission, consider `aria-live="polite"` on the error container
5. **Page titles**: Applications should set descriptive `<title>` elements for each form page
